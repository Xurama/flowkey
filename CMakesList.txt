# FlowKey/CMakeLists.txt

# Version minimale de CMake requise
cmake_minimum_required(VERSION 3.10)
project(FlowKey VERSION 0.1.0 LANGUAGES CXX)

# Configuration de la norme C++
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED True)

# Définir l'emplacement des fichiers sources communs
set(CORE_SOURCES
    Core/NetworkManager.cpp
)

# --- Configuration Boost ---
# Trouver le package Boost (nécessite les composants system et iostreams pour Asio)
find_package(Boost 1.70 COMPONENTS system REQUIRED) 
# Si Boost est trouvé, ajouter les chemins d'inclusion.
if(Boost_FOUND)
    include_directories(${Boost_INCLUDE_DIRS})
else()
    message(FATAL_ERROR "Boost version 1.70 ou supérieure n'a pas été trouvée.")
endif()

# --- Configuration du Serveur (Windows) ---
# Crée l'exécutable du Serveur à partir de Server/main.cpp et des sources Core
add_executable(FlowKey_Server Server/main.cpp ${CORE_SOURCES}) 
# Lier aux librairies Boost nécessaires (Boost::system est requis pour Asio)
target_link_libraries(FlowKey_Server PRIVATE Boost::system)

# --- Configuration du Client (macOS) ---
# Crée l'exécutable du Client
add_executable(FlowKey_Client Client/main.cpp ${CORE_SOURCES})
target_link_libraries(FlowKey_Client PRIVATE Boost::system)

# Définir le répertoire de sortie pour les exécutables
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)